// ... (기존 상단 코드는 그대로 유지된다고 가정하고 suichong 파트만 정확히 재작성)
  "suichong": {
    stateDisplay: {
        "seoin_stacks": "[서인]",
        "defense_timer": "[비늘]",
        "chumal_timer": "[추말]"
    },
    commonControls: [], 
    initialState: {
        seoin_stacks: 0,
        defense_timer: [],
        skill1_timer: 0,
        skill2_timer: 0,
        chumal_timer: 0
    },
    onTurn: (ctx) => {
        if (ctx.t > 1) {
            ctx.gainStack({ id: "seoin_stacks", originalId: "suichong_skill4", maxStacks: 4, label: "[서인] 1스택 획득", customTag: "패시브2" });
        }
    },
    onAttack: (ctx) => {
        const s = ctx.simState;
        const extraHits = [];

        if (ctx.isDefend) return { extraHits };

        if (s.chumal_timer > 0 && !ctx.isUlt) {
            const chumalCoef = ctx.getVal(6, 0); 
            if (chumalCoef > 0) {
                extraHits.push({ name: "세월의 흐름 (추말)", skillId: "suichong_skill7", val: chumalCoef, type: "추가공격", customTag: "패시브5", icon: "icon/passive5.webp" });
            }
        }

        if (!ctx.isUlt) {
            extraHits.push({
                name: "사악함을 제압하는 길상",
                skillId: "suichong_skill11",
                val: ctx.getVal(10, '추가공격'),
                type: "추가공격",
                customTag: "패시브2",
                icon: "icon/passive2.webp"
            });
        } else {
            extraHits.push({
                name: "사악함을 제압하는 길상",
                skillId: "suichong_skill10",
                val: ctx.getVal(9, '추가공격'),
                type: "추가공격",
                customTag: "패시브2",
                icon: "icon/passive2.webp"
            });

            const stacks = s.seoin_stacks || 0;
            if (stacks >= 3) {
                const count = (stacks === 4) ? 2 : 1;
                for (let i = 0; i < count; i++) {
                    extraHits.push({
                        name: `사악함을 제압하는 길상 [서인 #${i+1}]`,
                        skillId: "suichong_skill4",
                        val: ctx.getVal(3, '추가공격'),
                        type: "추가공격",
                        customTag: "패시브2",
                        icon: "icon/passive2.webp"
                    });
                }
            }
            
            if (stacks > 0) {
                ctx.log({ name: "서인 소모", icon: "icon/passive2.webp" }, `${stacks}스택 소모`);
                s.seoin_stacks = 0;
            }

            if (Array.isArray(s.defense_timer) && s.defense_timer.length > 0) {
                ctx.log({ name: "석숭의 비늘 소모", icon: "icon/passive5.webp" }, `데미지 증가 버프 초기화`);
                s.defense_timer = [];
            }

            if (ctx.stats.stamp && stacks >= 1) {
                const p = simParams.suichong;
                const triggerCount = (stacks >= 2) ? 2 : 1;
                for (let i = 0; i < triggerCount; i++) {
                    if (Math.random() < 0.5) {
                        ctx.applyBuff({ ...p.skill8_buff, prob: 1.0 });
                    }
                }
            }
        }
        return { extraHits };
    },
    getLiveBonuses: (ctx) => {
        const bonuses = { "공증": 0, "뎀증": 0 };
        const s = ctx.simState;

        if (s.skill1_timer > 0) bonuses["공증"] += ctx.getVal(0, '공증');
        if (s.skill2_timer > 0) bonuses["공증"] += ctx.getVal(1, '공증');

        const s8Stacks = Array.isArray(s.skill8_timer) ? s.skill8_timer.length : (s.skill8_timer > 0 ? 1 : 0);
        if (s8Stacks > 0) {
            bonuses["공증"] += s8Stacks * ctx.getVal(ctx.getSkillIdx("suichong_skill8"), '공증');
        }

        const defStacks = Array.isArray(s.defense_timer) ? s.defense_timer.length : 0;
        if (defStacks > 0) {
            bonuses["뎀증"] += defStacks * ctx.getVal(4, '뎀증');
        }

        return bonuses;
    }
  }
};